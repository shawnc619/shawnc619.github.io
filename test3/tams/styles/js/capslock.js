var CapsLock=(function(){var a=false;var d=[];var c=/Mac/.test(navigator.platform);function f(){return a}function b(g){d.push(g)}function e(j){if(!j){j=window.event}var i=a;var g=(j.charCode?j.charCode:j.keyCode);if(g>=97&&g<=122){a=j.shiftKey}else{if(g>=65&&g<=90&&!(j.shiftKey&&c)){a=!j.shiftKey}}if(a!=i){for(var h=0;h<d.length;h++){d[h](a)}}}if(window.addEventListener){window.addEventListener("keypress",e,false)}else{document.documentElement.attachEvent("onkeypress",e)}return{isOn:f,addListener:b}})();